---
title: 网络安全渗透测试流程
date: 2021-04-24 14:54:55
author: sec
---
# 渗透流程
## 前期与客户的交流阶段
&emsp;&emsp;在前期与客户的交流阶段中，渗透测试人员需要与客户进行商讨来确定整个渗透测试的范围，就是说针对目标的那些设备和那些问题进行测试。在整个商讨过程中要考虑的因素有以下几个：
- 渗透测试的目标网络
通常这个网络会包含很多主机，我们需要确定是渗透所涉及的IP地址范围和域名范围。
- 进行渗透测试所使用的方法
这个阶段我们可以采用的方法主要有黑盒测试，白盒测试以及灰盒测试。
- 进行渗透测试所需要的条件
如果是白盒测试就需要客户提供测试所需要的信息和权限，确定渗透可以进行的时间
- 渗透测试过程中的限制条件
确定好哪些能测试哪些不能测试
- 渗透测试的工期
根据客户需求，需要给出渗透测试进度表。（开始，结束时间等）
- 渗透测试的费用
- 渗透测试的预期目标
# 情报的搜集阶段
情报是指目标网络，服务器，应用程序等的所有信息。
如果是黑盒测试，信息搜集阶段是最重要的一个阶段。这个阶段使用的技术可以分为两种：
-  被动扫描
这种方式不会被对方发现。对于一个网络，我们可以在仅仅知道对方的域名，通过这个域名我们可以通过Whois查询到这个域名所有者的联系方式（电话号码，电子邮箱，公司所在地），以及域名注册和到期的时间等。通过搜索引擎可查找与该域名相关的电子邮件，博客，文件等。
- 主动扫描
这种扫描技术比较强，通常会使用专业的扫描工具对目标网络进行扫描。扫描后会得到目标网络的结构，目标网络所使用的设备类型，目标主机上的操作系统，目标主机上的开放端口，目标主机所提供的服务，目标主机所运行的应用程序等。
# 威胁建模阶段
如果把渗透测试看做一场对抗赛，那么威胁建模就相当于指定策略。在这个阶段主要考虑以下几个问题：
- 哪些资产是目标网络中的重要资产
- 攻击时采用的技术和手段
- 哪些攻击者可能对目标网络造成破坏
- 这些攻击者会使用哪些方法进行破坏

分攻击者发起攻击的可能性，可以更好地帮助我们确定渗透测试时使用的技术和工具。通常这些攻击者是以下几种：
- 有组织的恶意机构
- 黑客
- 脚本小子
- 内部员工

# 漏洞分析阶段
漏洞分析阶段是从目标网络中发现漏洞的过程。这个阶段我们会根据之前搜集的目标网络的操作系统，开放端口及服务程序等信息，查找和分析目标网络中的漏洞。这个阶段如果全靠人手工进行，那么会非常累。不过Kali Linux 2提供了大量的网络和应用漏洞评估工具。不光是网络的漏洞，还要考虑人的因素长时间研究目标人员的心理，以便对其实施欺骗，从而达到渗透目标。
# 漏洞利用阶段
找到目标网络的漏洞后，就可以对其进行测试了。在漏洞利用阶段我们关注的重点是，如果绕过网络的安全机制来控制目标网络或访问目标资源。如果我们在漏洞分析阶段顺利完成任务，那么我们就可以在此阶段准确，顺利的进行。漏洞利用阶段的渗透测试应该有精确的范围。这个阶段我们主要的目标就是获取我们之前评估的重要的资产。进行渗透测试时还需要考虑成功的概率和对目标网络造成的最大破坏。
# 后渗透攻击阶段
后渗透攻击阶段和漏洞利用阶段连接十分密切，作为渗透测试人员，必须尽可能地将目标网络渗透后可能产生的结果模拟出来。在后渗透攻击阶段可能要完成的任务包括以下几个：
- 控制权限的提升
- 登录凭证的获取
- 重要信息的获取
- 利用目标网络作为跳板
- 建立长期的控制通道
# 报告阶段
报告阶段是渗透测试最后一个阶段。要简单，直接且尽量避免大量专业术语向客户汇报测试目标网络出现的问题，以及可能产生的风险。这份报告应该包括目标网络最重要的威胁，使用渗透数据产生的表格和图标，以及对目标网络存在问题的修复方案，当前安全机制的改进建议等。


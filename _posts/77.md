---
title: XSS
date: 2021-03-31 22:02:30
author: sec
---
@[toc](目录)
# Xss
Xss 介绍

XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。这些恶意网页程序通常是JavaScript，但实际上也可以包括Java、 VBScript、ActiveX、 Flash 或者甚至是普通的HTML。攻击成功后，攻击者可能得到包括但不限于更高的权限（如执行一些操作）、私密网页内容、会话和cookie等各种内容。

 Xss分为以下三种
 
 1. 反射型Xss（非持久型跨站）
 2. 存储型Xss（持久型跨站）
 3. Dom型Xss 

## 反射型Xss（非持久型跨站）
介绍
反射型XSS也被称为非持久性XSS，是现在最容易出的XSS。当用户访问一个带有XSS代码的URL请求时，服务器接收数据后处理，然后把带有XSS代码的数据发送到浏览器，浏览器解析这段带有XSS代码的数据后，最终造成XSS漏洞。这个过程就像一次反射，故叫反射型XSS
危害：
1. 钓鱼网站

## 存储型Xss（持久型跨站）

介绍

将输入的代码存储到服务器中，在个人信息或者发表文章等的地方加入代码。如果可以执行js那么这些代码将会存储到服务器中。每当用户访问的时候都会触发，这样会造成蠕虫，盗取cookie等

## Dom型Xss
介绍

这里先附上一张w3c的dom树的图以便于更好的理解。
![在这里插入图片描述](img/20210331215332542.png)

Dom（Document Object Model）。DOM型XSS其实是一种特殊类型的反射型XSS，它是基于DOM文档对象模型的一种漏洞。dom - xss是通过url传入参数去控制触发的。DOM XSS 是由于浏览器解析机制导致的漏洞，而服务器不参与。
# XSS构造技巧
## 利用字符编码
![在这里插入图片描述](img/20210422132405659.png)一般来说这里没有XSS漏洞，因为变量处于双引号内。系统转义了双引号导致变量无法"escape"
但是有的页面返回的是GBK/GB2312编码，因此"%c1\"这两个字符组合在一起后会成为Unicode字符。在Firefox下会认为这是一个字符。所以构造
![在这里插入图片描述](img/20210422132622663.png)
## 绕过长度限制
1. payload：
![在这里插入图片描述](img/20210422132723118.png)但是由于有字数限制所以最后的代码成为了
![在这里插入图片描述](img/20210422133919811.png)我们可以利用事件(Event)来压缩所需要的的字数
![在这里插入图片描述](img/20210422134011361.png)
2. 在某些情况下我们可以利用注释符来绕过长度限制。如果有两个文本框。我们可以将两个文本框中间的内容进行注释。第一个文本框为![在这里插入图片描述](img/20210422134233416.png)                    第二个为![在这里插入图片描述](img/20210422134249102.png)最终是![在这里插入图片描述](img/20210422134309291.png)
中间代码都被注释掉了。
3. 利用`<base>`标签
`<base>`标签不常用，它的作用是定义页面上的所有使用相对路径标签的hosting地址。
例如打开一张不存在的照片![在这里插入图片描述](img/20210422134447764.png)这张图片实际上是Google的一张图片原地址为![在这里插入图片描述](img/20210422134518331.png)在`<img>`标签前加入`<base>`标签![在这里插入图片描述](img/20210422134556929.png)`<base>`标签将制定其后的标签从`http://www.google.com`获取URL
